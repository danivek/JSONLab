<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JSONLab</title>
    <meta name="description" content="View, edit, format, validate, repair, query, and compare JSON data" />
    <link rel="stylesheet" href="css/styles.css" />
    <!-- Monaco Editor from CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs/editor/editor.main.css" />
</head>

<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-brand" style="display: flex; align-items: center; gap: 12px">
                <div class="logo-container">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="246 258 534 379">
                        <g>
                            <path
                                d="M 539.37 621.92 C527.88,624.26 508.48,625.25 498.61,624.01 C475.92,621.15 454.58,613.20 436.09,600.72 C405.19,579.87 384.81,548.45 378.61,512.07 C376.57,500.11 376.54,479.39 378.55,467.00 C385.28,425.43 412.69,388.51 450.94,369.47 L 460.00 364.97 L 460.00 314.40 L 456.40 313.10 C451.21,311.22 445.46,304.88 444.12,299.56 C440.77,286.24 445.21,274.66 455.50,269.90 C459.23,268.17 463.02,268.04 512.50,268.04 C561.92,268.04 565.77,268.17 569.57,269.89 C579.64,274.47 584.46,287.50 580.89,300.50 C579.56,305.35 572.49,312.51 568.08,313.48 L 565.00 314.16 L 565.00 339.33 L 565.01 364.50 L 575.55 369.85 C611.80,388.24 636.14,419.76 645.57,460.52 C647.99,471.01 648.34,474.55 648.35,489.00 C648.37,507.47 646.54,518.64 640.88,534.69 C629.27,567.61 604.27,595.34 572.50,610.54 C559.10,616.94 552.23,619.30 539.37,621.92 ZM 492.00 604.49 C497.19,605.47 504.58,605.80 516.00,605.55 C533.54,605.17 541.82,603.56 556.82,597.60 C587.34,585.48 613.23,558.38 623.77,527.50 C629.54,510.59 631.59,485.78 628.56,469.63 C623.19,441.07 609.89,417.79 589.20,400.75 C579.34,392.62 573.89,389.22 560.77,383.03 C554.91,380.27 549.42,377.01 548.56,375.78 C547.21,373.86 547.00,368.35 547.00,335.28 L 547.00 297.00 L 553.28 297.00 C560.73,297.00 564.00,295.22 564.00,291.14 C564.00,289.63 563.46,287.86 562.80,287.20 C561.07,285.47 463.93,285.47 462.20,287.20 C461.54,287.86 461.00,289.63 461.00,291.14 C461.00,295.31 464.24,297.00 472.22,297.00 L 479.00 297.00 L 479.00 334.03 C479.00,363.23 478.71,371.76 477.62,374.36 C476.44,377.19 474.55,378.48 464.41,383.40 C448.30,391.20 440.12,396.84 429.47,407.48 C413.86,423.08 403.70,441.04 398.31,462.59 C395.91,472.18 395.58,475.38 395.61,489.00 C395.65,507.40 398.26,520.67 404.81,535.71 C419.90,570.39 454.03,597.31 492.00,604.49 ZM 703.26 623.68 C697.54,625.88 694.43,626.35 683.00,626.75 C675.58,627.01 669.16,626.87 668.75,626.44 C668.34,626.02 668.00,619.51 668.00,611.98 L 668.00 598.28 L 673.84 597.67 C685.87,596.42 692.80,591.24 697.08,580.33 C699.27,574.75 699.40,572.87 700.05,537.00 C700.58,507.56 701.06,498.37 702.28,494.23 C705.14,484.52 709.60,476.50 715.86,469.81 L 722.00 463.24 L 718.59 460.64 C714.15,457.25 706.45,445.62 704.07,438.69 C700.75,429.06 700.00,419.86 699.99,388.81 C699.97,365.58 699.62,357.03 698.49,352.22 C695.01,337.48 688.68,331.50 675.11,330.15 L 668.50 329.50 L 668.22 314.60 L 667.94 299.70 L 681.72 300.27 C706.43,301.30 719.40,308.02 727.50,324.01 C733.60,336.04 734.19,340.84 734.92,384.50 C735.56,422.34 735.72,424.82 737.80,430.47 C742.21,442.43 750.70,448.89 763.18,449.78 L 770.05 450.27 L 769.50 477.50 L 762.50 478.13 C758.65,478.47 753.85,479.45 751.83,480.29 C746.16,482.67 740.47,489.21 737.92,496.29 C735.79,502.17 735.64,504.55 735.00,541.50 C734.26,584.05 733.69,589.18 728.54,600.52 C723.22,612.21 716.08,618.75 703.26,623.68 ZM 357.00 598.26 L 357.00 627.00 L 345.75 626.92 C333.18,626.82 325.58,625.33 317.77,621.41 C305.42,615.21 297.84,605.80 293.92,591.77 C291.73,583.96 291.57,581.23 290.98,543.00 C290.32,500.13 290.36,500.47 285.20,490.40 C284.10,488.26 282.14,485.52 280.85,484.31 C277.45,481.15 270.07,478.05 265.88,478.02 C263.88,478.01 260.84,477.72 259.12,477.38 L 256.00 476.75 L 256.00 450.27 L 262.31 449.77 C269.16,449.22 277.09,446.19 280.84,442.70 C282.14,441.49 284.31,438.31 285.68,435.63 C290.29,426.57 290.96,420.14 290.99,385.00 C291.02,346.61 291.98,337.79 297.35,326.48 C305.93,308.42 322.07,300.00 348.11,300.00 L 358.05 300.00 L 357.50 329.50 L 350.90 330.15 C342.94,330.94 337.24,333.67 333.12,338.66 C326.94,346.16 326.71,347.80 325.98,389.00 C325.24,430.52 325.00,432.30 318.31,445.99 C316.06,450.61 312.64,455.49 309.38,458.75 L 304.11 464.02 L 306.65 465.69 C310.25,468.05 318.56,480.22 320.97,486.66 C325.05,497.56 326.00,507.45 326.00,539.08 C326.00,557.35 326.44,570.95 327.12,574.20 C328.48,580.59 331.94,587.70 335.16,590.70 C338.50,593.81 345.60,596.75 351.75,597.56 ZM 485.48 559.80 C474.83,562.48 467.40,561.72 457.40,556.95 C451.15,553.97 443.57,547.07 439.78,540.93 C438.62,539.04 436.85,534.87 435.84,531.66 C429.91,512.82 439.47,491.70 457.69,483.37 C466.19,479.49 479.63,478.88 488.29,481.99 C506.73,488.62 518.19,507.54 515.09,526.26 C512.42,542.45 500.42,556.04 485.48,559.80 ZM 552.64 478.95 C538.95,485.58 523.99,482.87 513.31,471.83 C506.94,465.25 504.02,458.10 504.00,449.00 C503.99,438.90 506.22,432.98 512.74,425.93 C520.22,417.83 525.82,415.52 538.00,415.52 C546.35,415.51 548.11,415.83 552.53,418.16 C559.51,421.84 565.20,427.66 568.60,434.61 C571.07,439.63 571.49,441.68 571.47,448.50 C571.45,454.98 570.95,457.56 568.84,462.12 C565.23,469.89 559.89,475.45 552.64,478.95 ZM 467.32 549.62 C480.01,553.75 496.14,545.70 502.34,532.12 C506.96,522.00 504.15,507.31 496.05,499.21 C489.95,493.11 485.63,491.53 475.00,491.51 C466.85,491.50 464.81,491.85 460.66,493.97 C444.14,502.41 439.80,525.40 452.08,539.36 C456.61,544.50 461.29,547.65 467.32,549.62 ZM 527.17 469.40 C536.36,473.98 545.67,472.74 553.48,465.88 C564.38,456.31 563.20,438.01 551.13,429.52 C547.42,426.92 545.78,426.46 539.07,426.15 C529.76,425.73 525.21,427.60 519.60,434.15 C509.80,445.60 513.44,462.55 527.17,469.40 ZM 569.98 552.75 C559.54,558.09 546.99,553.51 541.90,542.50 C531.95,521.02 561.05,502.49 576.72,520.33 C585.56,530.40 582.22,546.50 569.98,552.75 ZM 507.02 406.15 C500.27,409.73 493.25,407.46 488.27,400.08 C484.03,393.78 486.25,384.44 492.92,380.60 C497.13,378.16 504.95,378.08 508.55,380.44 C517.80,386.50 516.95,400.87 507.02,406.15 ZM 555.06 545.17 C561.87,548.82 569.09,546.32 572.23,539.22 C574.67,533.69 574.00,529.28 570.07,525.07 C567.58,522.41 566.51,522.00 562.05,522.00 C559.22,522.00 555.63,522.66 554.09,523.46 C551.04,525.03 548.00,530.38 548.00,534.17 C548.00,537.94 551.37,543.19 555.06,545.17 ZM 470.55 514.55 C468.19,516.90 463.61,517.69 460.23,516.33 C458.47,515.62 456.00,510.59 456.00,507.72 C456.00,501.35 466.80,498.39 470.93,503.63 C473.73,507.20 473.58,511.51 470.55,514.55 ZM 534.69 443.83 C531.79,446.55 529.01,446.59 526.19,443.96 C523.20,441.17 523.21,435.66 526.22,433.56 C529.33,431.38 532.57,431.62 534.96,434.19 C537.66,437.09 537.55,441.14 534.69,443.83 ZM 497.25 398.01 L 497.42 398.11 C499.41,399.33 500.35,399.90 501.24,399.83 C502.06,399.76 502.84,399.13 504.37,397.93 C509.68,393.75 506.22,385.11 499.75,386.40 C493.35,387.68 491.83,394.71 497.25,398.01 ZM 560.80 531.80 C560.14,532.46 558.66,533.00 557.50,533.00 C552.65,533.00 551.13,526.66 555.57,524.98 C560.42,523.13 564.35,528.25 560.80,531.80 Z"
                                fill="currentColor" />
                        </g>
                    </svg>
                </div>
                <h1>JSONLab</h1>
            </div>
            <div class="header-actions">
                <button id="btn-mode-normal" class="btn btn-secondary" title="Normal View (Single Editor)">
                    <i data-lucide="square" class="icon"></i> Normal
                </button>
                <button id="btn-mode-split" class="btn btn-secondary active" title="Split View">
                    <i data-lucide="columns" class="icon"></i> Split
                </button>
                <button id="btn-mode-compare" class="btn btn-secondary" title="Compare Left vs Right">
                    <i data-lucide="git-compare" class="icon"></i> Compare
                </button>
                <button id="btn-mode-query" class="btn btn-secondary" title="Query JSON">
                    <i data-lucide="search-code" class="icon"></i> Query
                </button>
                <div class="toolbar-divider" style="height: 24px; margin: 0 8px"></div>
                <button id="btn-theme" class="btn btn-icon" title="Toggle dark mode">
                    <i data-lucide="moon" id="theme-icon"></i>
                </button>
            </div>
        </header>

        <!-- Main Editor Area -->
        <main class="main-content">
            <div id="editors-container" class="editors-container">
                <!-- Editors will be injected here by App.js -->
            </div>

            <!-- Compare Panel -->
            <div id="compare-panel" class="editor-panel compare-panel">
                <div class="compare-header">
                    <span>Original (Left)</span>
                    <span>Modified (Right)</span>
                </div>
                <!-- Diff Editor -->
                <div id="monaco-diff-container" class="monaco-container"></div>
                <!-- Diff Summary (Restored) -->
                <div id="diff-resize-handle" class="diff-resize-handle"></div>
                <div id="diff-summary" class="diff-output"></div>
            </div>

            <!-- Query Panel -->
            <!-- Query Panel -->
            <div id="query-panel" class="editor-panel query-panel">
                <div class="query-input-container">
                    <div class="query-controls">
                        <div class="query-input-wrapper">
                            <label for="query-input">JMESPath:</label>
                            <textarea id="query-input" class="query-input"
                                placeholder="e.g. locations[?state == 'WA'].name | sort(@)"></textarea>
                        </div>
                        <button id="btn-query-apply" class="btn btn-success" title="Apply result to Main Editor">
                            Apply
                        </button>
                    </div>
                </div>
                <div class="query-split-view">
                    <div class="query-pane">
                        <div class="panel-header">Original Input</div>
                        <div id="query-editor-input" class="monaco-container"></div>
                    </div>
                    <div class="query-pane">
                        <div class="panel-header">Query Result (Preview)</div>
                        <div id="query-editor-output" class="monaco-container"></div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Status Bar -->
        <footer class="status-bar"></footer>

        <!-- Hidden file input -->
        <input type="file" id="file-input" accept=".json,.csv,.txt" hidden />

        <!-- URL Import Modal -->
        <div id="url-modal" class="modal hidden">
            <div class="modal-content">
                <h2>Load JSON from URL</h2>
                <input type="url" id="url-input" class="modal-input" placeholder="https://api.example.com/data.json" />
                <div class="modal-actions">
                    <button id="btn-url-cancel" class="btn btn-secondary">Cancel</button>
                    <button id="btn-url-load" class="btn btn-primary">Load</button>
                </div>
            </div>
        </div>

        <!-- CSV Options Modal -->
        <div id="csv-modal" class="modal hidden">
            <div class="modal-content">
                <h2>CSV Options</h2>
                <label>
                    Delimiter:
                    <select id="csv-delimiter">
                        <option value=",">Comma (,)</option>
                        <option value=";">Semicolon (;)</option>
                        <option value="\t">Tab</option>
                    </select>
                </label>
                <div class="modal-actions">
                    <button id="btn-csv-cancel" class="btn btn-secondary">Cancel</button>
                    <button id="btn-csv-confirm" class="btn btn-primary">Convert</button>
                </div>
            </div>
        </div>
    </div>

    <!-- JSON Repair Library -->
    <script src="https://cdn.jsdelivr.net/npm/jsonrepair@3.8.0/lib/umd/jsonrepair.min.js"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Monaco Editor Loader -->
    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs/loader.js"></script>

    <!-- App Scripts -->
    <script type="module" src="js/utils/jsonUtils.js"></script>
    <script type="module" src="js/utils/csvUtils.js"></script>
    <script type="module" src="js/utils/diffUtils.js"></script>
    <script type="module" src="js/utils/queryUtils.js"></script>
    <script type="module" src="js/editor/textEditor.js"></script>
    <script type="module" src="js/editor/treeView.js"></script>
    <script type="module" src="js/editor/tableView.js"></script>
    <script type="module" src="js/ui/theme.js"></script>
    <script type="module" src="js/ui/modal.js"></script>
    <script type="module" src="js/ui/toolbar.js"></script>
    <script type="module" src="js/ui/editorToolbar.js"></script>
    <script type="module" src="js/editor/jsonEditor.js"></script>
    <script type="module" src="js/app.js"></script>
</body>

</html>